<!doctype html>
<title>Newsaliser</title>
<script
        src="https://code.jquery.com/jquery-3.2.1.js"
        integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
        crossorigin="anonymous"></script>

<link rel=stylesheet type=text/css href="{{ url_for('static', filename='bootstrap-3.3.5/css/bootstrap.min.css') }}">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs-3.3.7/dt-1.10.15/b-1.3.1/b-colvis-1.3.1/sc-1.4.2/datatables.min.css"/>
 
<script type="text/javascript" src="https://cdn.datatables.net/v/bs-3.3.7/dt-1.10.15/b-1.3.1/b-colvis-1.3.1/sc-1.4.2/datatables.min.js"></script>

<div id="loader"></div>
<div class="container">
  <h1> Articles</h1>
  <div class="row">
    <div class="input-group">
      <input type="text" class="form-control" placeholder="article URL" id="newArticle">
      <span class="input-group-btn">
        <button class="btn btn-default" type="button" id="addNew">Add New Article</button>
      </span>
    </div>
    <div class="input-group">
      <input type="text" class="form-control" placeholder="Search Term" id="searchArticles">
      <span class="input-group-btn">
        <button class="btn btn-default" type="button" id="search">Search for Articles</button>
      </span>
    </div>
  </div>
  <br>

  <div class="row">
<table id="example" class="display" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th>id</th>
            <th>title</th>
            <th>date</th>
            <th>domain</th>
            <th>author</th>
          </tr>
          <tbody>
          {% for article in articles %}
          <tr>
            <td>{{article.id}}</th>
            <td><span><a href="/articles/{{article.id}}">{{article.title}}</a></th>
            <td>{{article.date}}</th>
            <td>{{article.domain}}</th>
            <td>{{article.author}}</th>            
          </tr>
            {% endfor %}
    </table>
  </div>
</div>


</div>
<script type="text/javascript">
$(document).ready(function  () {
  function mkLoad(){
        $('#loader').html('<img src=/static/img/SPINNAZ.gif />');
  }
  function unLoad(){
    $('#loader').html('');
  }  

    $('#example').DataTable( {
        "dom": '<"top"iflp<"clear">>rt<"bottom"iflp<"clear">>'
    } );
  $("#addNew").on("click", function  () {
    mkLoad()
  	var url = $('#newArticle').val();
  	console.log(url);
    var res = $.post("/articles/",url)
    res.done(function  (data) {
      unLoad();
      alert(data.result);
      location = '/articles/' + data.id
    })
    

  });
  $('#search').on('click',function () {
    var term = $('#searchArticles').val();
    location = '/articles/search/'+term
  })
})
</script>

